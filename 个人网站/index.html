<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ç²‰ç³»ä¸ªäººä½œå“é›† Â· å…¨å±ç¿»é¡µ</title>
    <style>
      /* åŸºç¡€ä¸è‡ªé€‚åº” */
      :root {
        --wrap-w-desktop: 66vw;
        --wrap-w-max: 820px;
        --wrap-w-mobile: 92vw;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        background: #f6e9ea;
        font-family: system-ui, -apple-system, "PingFang SC", "Microsoft YaHei",
          sans-serif;
        color: #2b2b2b;
      }

      .wrap {
        width: min(var(--wrap-w-desktop), var(--wrap-w-max));
        margin: 32px auto 56px;
        position: relative; /* ç‚¹èµç›¸å¯¹å®šä½ */
      }
      @media (max-width: 1024px) {
        .wrap {
          width: min(72vw, var(--wrap-w-max));
        }
      }
      @media (max-width: 768px) {
        .wrap {
          width: var(--wrap-w-mobile);
          margin: 20px auto 48px;
        }
      }

      .bg {
        width: 100%;
        height: auto;
        display: block;
        border-radius: 22px;
        box-shadow: 0 18px 60px rgba(0, 0, 0, 0.12);
      }
      svg {
        position: absolute;
        inset: 0;
        border-radius: 22px;
        z-index: 20;
        max-width: 100%;
        height: 100%;
      }
      .hit {
        fill: transparent;
        stroke: transparent;
        cursor: pointer;
        pointer-events: auto;
        transition: filter 0.2s;
      }
      .hit:hover {
        filter: drop-shadow(0 0 8px rgba(255, 130, 170, 0.45));
      }

      /* é¡¶éƒ¨å¯¼èˆª */
      .topnav {
        position: fixed;
        top: 16px;
        right: 16px;
        z-index: 70;
        display: flex;
        gap: 8px;
        align-items: center;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.65);
        backdrop-filter: blur(6px);
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 999px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      }
      .topnav a {
        padding: 6px 10px;
        border-radius: 999px;
        text-decoration: none;
        color: #2b2b2b;
        font-size: 14px;
      }
      .topnav a:hover {
        background: rgba(255, 255, 255, 0.9);
      }

      /* å…¨å±æ¨¡å—ï¼ˆæ–¹æ¡ˆå››ï¼šå¡ç‰‡å±…ä¸­ï¼‰ */
      .screen {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 80;
        background: linear-gradient(180deg, #fff6fb 0%, #f8e9ef 100%);
      }
      .screen.show {
        display: block;
        animation: fadin 0.22s ease;
      }
      @keyframes fadin {
        from {
          opacity: 0;
          transform: translateY(8px);
        }
        to {
          opacity: 1;
          transform: none;
        }
      }
      .page {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
        pointer-events: none;
      }
      .page .card {
        width: min(92vw, 900px);
        max-height: 82vh;
        overflow: auto;
        background: rgba(255, 255, 255, 0.78);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 28px;
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.22);
        padding: 22px;
        pointer-events: auto;
        /* è¡¥ä¸ â‘£ï¼šç»™å¡ç‰‡å·¦å³ç•™å‡ºå®‰å…¨è¾¹è·ï¼Œé¿å…è¢«å·¦å³æŒ‰é’®é®ä½ */
        margin: 0 88px;
      }
      @media (max-width: 768px) {
        .page .card {
          margin: 0 64px;
        }
      }
      @media (max-width: 420px) {
        .page .card {
          margin: 0 52px;
        }
      }
      .page h2 {
        margin: 0 0 8px;
      }

      /* ç¿»é¡µ/è¿”å› */
      .screen .nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 46px;
        height: 46px;
        border-radius: 999px;
        border: 0;
        background: rgba(255, 255, 255, 0.86);
        backdrop-filter: blur(6px);
        cursor: pointer;
        z-index: 120;
      }
      .screen .nav.prev {
        left: 16px;
      }
      .screen .nav.next {
        right: 16px;
      }
      .backHome {
        position: absolute;
        top: 16px;
        left: 16px;
        border: 0;
        background: rgba(255, 255, 255, 0.82);
        backdrop-filter: blur(6px);
        border-radius: 999px;
        padding: 8px 12px;
        cursor: pointer;
        z-index: 120;
      }

      /* ç‚¹èµæŒ‰é’®ï¼šä½äºå¿ƒå½¢çƒ­åŒºä¸­å¿ƒï¼ˆç›¸å¯¹ .wrapï¼‰ */
      .like {
        position: absolute;
        display: flex;
        gap: 6px;
        align-items: center;
        transform: translate(-50%, -50%);
        background: #fff;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 999px;
        padding: 8px 12px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.18);
        font-weight: 700;
        z-index: 150;
      }

      /* ä½œå“é›†ç½‘æ ¼ä¸ç¯ç®± */
      .filters {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin: 6px 0 12px;
      }
      .filter-btn {
        border: 1px solid rgba(0, 0, 0, 0.1);
        background: #fff;
        border-radius: 999px;
        padding: 6px 10px;
        cursor: pointer;
      }
      .filter-btn.active {
        background: #ffe8f1;
        border-color: #ffb3cc;
      }
      .works-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 14px;
      }
      .work-card {
        border: 1px solid rgba(0, 0, 0, 0.06);
        border-radius: 12px;
        overflow: hidden;
        background: #fff;
        display: flex;
        flex-direction: column;
      }
      .work-card .thumb {
        aspect-ratio: 4/3;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .work-card .thumb img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .work-card .meta {
        padding: 10px 12px;
        display: flex;
        gap: 6px;
        align-items: center;
        justify-content: space-between;
      }
      .tag {
        font-size: 12px;
        padding: 3px 8px;
        border-radius: 999px;
        background: #f6f6f6;
      }
      .open-btn {
        border: 1px solid rgba(0, 0, 0, 0.1);
        background: #fff;
        border-radius: 8px;
        padding: 6px 8px;
        text-decoration: none;
        color: inherit;
      }

      .lightbox {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.65);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 200;
      }
      .lightbox.show {
        display: flex;
      }
      .lightbox img {
        max-width: 92vw;
        max-height: 86vh;
        border-radius: 14px;
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.45);
        user-select: none;
      }

      /* è¡¥ä¸ â‘¡ï¼šæ‚¬æµ®æç¤º tooltip æ ·å¼ */
      .tip {
        position: fixed;
        z-index: 170;
        pointer-events: none;
        opacity: 0;
        transform: translate(-50%, -120%);
        transition: opacity 0.12s ease;
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(6px);
        border: 1px solid rgba(0, 0, 0, 0.08);
        padding: 6px 10px;
        border-radius: 10px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        font-size: 13px;
        color: #2b2b2b;
      }
      .tip.show {
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <div class="topnav">
      <a data-key="kitchen">å…¬ä¼—å·</a>
      <a data-key="dining">ä½œå“é›†</a>
      <a data-key="bed">è”ç³»æˆ‘</a>
      <a data-key="bath">å…³äºæˆ‘</a>
      <a data-key="utility">ç›¸å†Œ</a>
      <a data-key="stairs">ç¬”è®°</a>
    </div>

    <!-- é¦–é¡µ -->
    <div class="wrap" id="home">
      <img src="house.png" class="bg" id="bg" alt="æˆ¿å­æ’å›¾" />
      <svg viewBox="0 0 100 133.333" preserveAspectRatio="none" id="svg">
        <polygon id="kitchen" class="hit"></polygon>
        <polygon id="bath" class="hit"></polygon>
        <polygon id="dining" class="hit"></polygon>
        <polygon id="bed" class="hit"></polygon>
        <polygon id="utility" class="hit"></polygon>
        <polygon id="stairs" class="hit"></polygon>
        <polygon id="heartZone" class="hit"></polygon>
      </svg>
      <button class="like" id="likeBtn">
        â¤ï¸ <span id="likeCount">0</span>
      </button>
    </div>

    <!-- è¡¥ä¸ â‘ ï¼šæ‚¬æµ®æç¤ºå±‚ -->
    <div id="tooltip" class="tip"></div>

    <!-- å…¨å±æ¨¡å—å¡ç‰‡ -->
    <div class="screen" id="screen">
      <button class="backHome" id="backHome">ğŸ </button>
      <button class="nav prev" id="prevBtn">â€¹</button>
      <button class="nav next" id="nextBtn">â€º</button>
      <div class="page"><div class="card" id="pageCard"></div></div>
    </div>

    <!-- å›¾ç‰‡ç¯ç®± -->
    <div class="lightbox" id="lightbox"><img alt="" /></div>

    <script>
      /* ====== åæ ‡ï¼ˆä½ çš„æˆæœï¼‰ ====== */
      const AREAS = {
        kitchen: [
          [16.567460317460316, 38.18332605820106],
          [36.11111111111111, 20.10576984126984],
          [35.11904761904761, 64.10918716931216],
          [14.880952380952381, 63.668271164021164],
        ],
        bath: [
          [38.65476190476191, 20.973557539682538],
          [49.702380952380956, 10.670167328042329],
          [85.41666666666666, 37.56604365079365],
          [85.71428571428571, 64.28555357142857],
          [37.59920634920635, 63.31553835978836],
        ],
        dining: [
          [15.079365079365079, 67.37196560846562],
          [59.523809523809526, 66.4019503968254],
          [58.92857142857143, 106.8780396825397],
          [13.59126984126984, 105.99620767195768],
        ],
        bed: [
          [62.51190476190476, 67.22925132275132],
          [75, 67.1955992063492],
          [87.51190476190476, 67.22925132275132],
          [88.69047619047619, 105.90802447089946],
          [61.70634920634921, 106.78985648148148],
        ],
        utility: [
          [7.87037037037037, 110.49355092592593],
          [39.120370370370374, 111.59094187242798],
          [38.04012345679013, 140.39745421810701],
          [8.256172839506174, 140.39745421810701],
        ],
        stairs: [
          [41.358024691358025, 111.72811574074073],
          [59.49074074074075, 112.68833281893005],
          [59.79938271604939, 140.39745421810701],
          [41.2037037037037, 140.39745421810701],
        ],
        heartZone: [
          [74.20634920634922, 138.35944246031744],
          [69.3452380952381, 131.3047863756614],
          [70.23809523809524, 124.16194708994709],
          [75.1984126984127, 118.78277182539682],
          [82.53968253968253, 120.10551984126984],
          [89.18650793650794, 118.69458862433862],
          [94.84126984126985, 124.86741269841269],
          [95.03968253968254, 131.21660317460316],
          [91.56746031746032, 138.35944246031744],
          [82.0436507936508, 143.29770171957674],
        ],
      };

      /* ====== æ¸²æŸ“å¤šè¾¹å½¢ ====== */
      const svg = document.getElementById("svg");
      for (const id in AREAS) {
        const el = document.getElementById(id);
        if (el)
          el.setAttribute(
            "points",
            AREAS[id].map((p) => p.join(",")).join(" ")
          );
      }

      /* ====== é¡¶éƒ¨å¯¼èˆª/æ ‡ç­¾ï¼ˆå«å¿ƒå½¢è¯´æ˜ï¼‰ ====== */
      const order = ["kitchen", "dining", "bed", "bath", "utility", "stairs"];
      const labels = {
        kitchen: "å…¬ä¼—å·",
        dining: "ä½œå“é›†",
        bed: "è”ç³»æˆ‘",
        bath: "å…³äºæˆ‘",
        utility: "ç›¸å†Œ",
        stairs: "ç¬”è®°",
        heartZone: "ç‚¹èµ",
      };
      document
        .querySelectorAll(".topnav a")
        .forEach((a) => (a.onclick = () => openPage(a.dataset.key)));

      /* ====== ç‚¹èµï¼ˆæœ¬åœ°å•ç¥¨ï¼Œå¯å–æ¶ˆï¼‰ ====== */
      const likeKey = "site-like-count-v1";
      const likedKey = "site-like-liked-v1";
      const likeBtn = document.getElementById("likeBtn");
      const likeCount = document.getElementById("likeCount");
      function loadLike() {
        const liked = localStorage.getItem(likedKey) === "1";
        likeCount.textContent = Number(localStorage.getItem(likeKey) || 0);
        likeBtn.classList.toggle("on", liked);
      }
      function toggleLike() {
        let c = Number(localStorage.getItem(likeKey) || 0);
        const liked = localStorage.getItem(likedKey) === "1";
        if (liked) {
          c = Math.max(0, c - 1);
          localStorage.setItem(likedKey, "0");
        } else {
          c = c + 1;
          localStorage.setItem(likedKey, "1");
        }
        localStorage.setItem(likeKey, c);
        loadLike();
        placeLike();
      }
      likeBtn.onclick = toggleLike;
      loadLike();

      /* ====== â¤ å®šä½åˆ°å¿ƒå½¢çƒ­åŒºå‡ ä½•ä¸­å¿ƒï¼ˆgetBBoxï¼‰ ====== */
      function placeLike() {
        const wrap = document.getElementById("home");
        const heart = document.getElementById("heartZone");
        if (!wrap || !heart) return;

        const vbW = 100,
          vbH = 133.333; // viewBox å›ºå®šå€¼
        const box = heart.getBBox(); // SVG åæ ‡ç³»
        const cx = box.x + box.width / 2;
        const cy = box.y + box.height / 2;

        const r = wrap.getBoundingClientRect();
        likeBtn.style.left = r.width * (cx / vbW) + "px";
        likeBtn.style.top = r.height * (cy / vbH) + "px";
      }
      window.addEventListener("load", placeLike);
      window.addEventListener("resize", placeLike);

      /* ====== è¡¥ä¸ â‘¢ï¼šæ‚¬æµ®æç¤º tooltip ====== */
      const tooltip = document.getElementById("tooltip");
      function showTip(text, x, y) {
        tooltip.textContent = text;
        tooltip.style.left = x + "px";
        tooltip.style.top = y + "px";
        tooltip.classList.add("show");
      }
      function hideTip() {
        tooltip.classList.remove("show");
      }
      svg.querySelectorAll(".hit").forEach((poly) => {
        const name = labels[poly.id];
        if (!name) return;
        poly.addEventListener("mousemove", (e) =>
          showTip(name, e.clientX, e.clientY)
        );
        poly.addEventListener("mouseleave", hideTip);
        poly.addEventListener(
          "touchstart",
          (e) => {
            const t = e.touches[0];
            showTip(name, t.clientX, t.clientY);
            setTimeout(hideTip, 900);
          },
          { passive: true }
        );
      });

      /* ====== å…¨å±æ¨¡å—ï¼ˆæ–¹æ¡ˆå››ï¼‰ ====== */
      const screenEl = document.getElementById("screen");
      const pageCard = document.getElementById("pageCard");
      const prevBtn = document.getElementById("prevBtn");
      const nextBtn = document.getElementById("nextBtn");
      const backHome = document.getElementById("backHome");
      let current = 0;

      function openPage(key) {
        hideTip(); // è¿›é¡µé¢æ—¶éšè—æç¤º
        current = Math.max(0, order.indexOf(key));
        if (current < 0) current = 0;
        renderPage();
        screenEl.classList.add("show");
      }
      function closePage() {
        screenEl.classList.remove("show");
      }
      backHome.onclick = closePage;
      prevBtn.onclick = () => {
        current = (current - 1 + order.length) % order.length;
        renderPage();
      };
      nextBtn.onclick = () => {
        current = (current + 1) % order.length;
        renderPage();
      };
      window.addEventListener("keydown", (e) => {
        if (!screenEl.classList.contains("show")) return;
        if (e.key === "ArrowLeft") prevBtn.click();
        if (e.key === "ArrowRight") nextBtn.click();
        if (e.key === "Escape") closePage();
      });

      /* ====== ä½œå“é›†æ•°æ®ï¼ˆç¤ºä¾‹ï¼‰ ====== */
      const LINKS = {
        wechat: "https://mp.weixin.qq.com/s/EEK0YhOpDj9HWEAe6oWjBg",
      };
      const WORKS = [
        { type: "image", src: "gallery/1.jpg", title: "protrait" },
        { type: "image", src: "gallery/2.jpg", title: "æ’ç”» 2" },
        {
          type: "link",
          href: "https://mp.weixin.qq.com/s/EEK0YhOpDj9HWEAe6oWjBg",
          title: "æ™šä¸Šæœ‰èšŠå­åœ¨è€³æœµè¾¹å—¡å—¡å«ï¼Œç¡ä¸ç€æ€ä¹ˆåŠï¼ŸğŸ¦ŸğŸ¦ŸğŸ¦Ÿ",
        },
        {
          type: "doc",
          href: "docs/ã€Šæ–‡åŒ–å…·æœ‰å¤šæ ·æ€§ã€‹æ•™å­¦è®¾è®¡.docx",
          title: "ã€Šæ–‡åŒ–å…·æœ‰å¤šæ ·æ€§ã€‹æ•™å­¦è®¾è®¡ï¼ˆdocxï¼‰",
          thumb: "docs/ã€Šæ–‡åŒ–å…·æœ‰å¤šæ ·æ€§ã€‹æ•™å­¦è®¾è®¡.png",
        },
        { type: "image", src: "gallery/3.jpg", title: "æ’ç”» 3" },
      ];

      /* ====== ç¯ç®± ====== */
      const lightbox = document.getElementById("lightbox");
      lightbox.addEventListener("click", () =>
        lightbox.classList.remove("show")
      );
      function openLightbox(src) {
        const img = lightbox.querySelector("img");
        img.src = src;
        lightbox.classList.add("show");
      }

      /* ====== æ¸²æŸ“å…¨å±å¡ç‰‡å†…å®¹ ====== */
      function renderPage() {
        const key = order[current];
        const title = labels[key] || "";
        let html = "";
        if (key === "kitchen")
          html = `<h2>${title}</h2><p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ‰“å¼€å…¬ä¼—å·æ–‡ç« åˆ—è¡¨ã€‚</p><p><a target="_blank" href="${LINKS.wechat}" class="open-btn">æ‰“å¼€å…¬ä¼—å·æ–‡ç« </a></p>`;
        if (key === "dining") {
          const filters = ["all", "image", "link", "file"];
          html = `<h2>${title}</h2>
      <div class="filters">${filters
        .map(
          (f, i) =>
            `<button class="filter-btn ${
              i === 0 ? "active" : ""
            }" data-f="${i}">${f}</button>`
        )
        .join("")}</div>
      <div class="works-grid" id="worksGrid"></div>`;
        }
        if (key === "bed")
          html = `<h2>${title}</h2>
    <div style="display:flex;gap:16px;align-items:center">
      <img src="avatar.jpg" alt="å¤´åƒ" style="width:96px;height:96px;border-radius:50%;object-fit:cover;border:3px solid #fff;box-shadow:0 6px 18px rgba(0,0,0,.18)"/>
      <div><p>æ¬¢è¿æ¥èŠï½</p><p>ï¼ˆè¿™é‡Œå¡«ä½ çš„å¾®ä¿¡/é‚®ç®±/é“¾æ¥ï¼‰</p></div>
    </div>`;
        if (key === "bath")
          html = `<h2>${title}</h2><p>è¿™é‡Œå¯ä»¥æ”¾è‡ªæˆ‘ä»‹ç»ã€ç®€å†ä¸æŠ€èƒ½æ ˆã€‚</p>`;
        if (key === "utility")
          html = `<h2>${title}</h2><p>ä¹‹åæ¥å…¥ä½ çš„å›¾ç‰‡é›†ã€‚</p>`;
        if (key === "stairs")
          html = `<h2>${title}</h2><p>å­¦ä¹  / è¯»ä¹¦ / æŠ•èµ„ç¬”è®°å¯ä»¥æ”¾è¿™é‡Œã€‚</p>`;

        pageCard.innerHTML = `<div class="inner">${html}</div>`;

        if (key === "dining") {
          const grid = pageCard.querySelector("#worksGrid");
          const btns = pageCard.querySelectorAll(".filter-btn");
          btns.forEach((b) =>
            b.addEventListener("click", () => {
              btns.forEach((x) => x.classList.remove("active"));
              b.classList.add("active");
              renderWorks(+b.dataset.f);
            })
          );

          function renderWorks(fIdx) {
            grid.innerHTML = "";
            const list = WORKS.filter((w) => {
              if (fIdx === 0) return true;
              if (fIdx === 1) return w.type === "image";
              if (fIdx === 2) return w.type === "link";
              if (fIdx === 3) return w.type === "doc";
            });
            list.forEach((w) => {
              const card = document.createElement("div");
              card.className = "work-card";
              if (w.type === "image") {
                card.innerHTML = `<div class="thumb"><img src="${w.src}" alt="${
                  w.title || ""
                }"></div>
                          <div class="meta"><span>${
                            w.title || "å›¾ç‰‡"
                          }</span><span class="tag">å›¾ç‰‡</span></div>`;
                card
                  .querySelector(".thumb img")
                  .addEventListener("click", () => openLightbox(w.src));
              } else if (w.type === "link") {
                card.innerHTML = `<div class="thumb">ğŸ”—</div>
                          <div class="meta"><span>${
                            w.title || "å¤–éƒ¨é“¾æ¥"
                          }</span>
                          <a class="open-btn" target="_blank" href="${
                            w.href
                          }">æ‰“å¼€</a></div>`;
              } else if (w.type === "doc") {
                const t = w.thumb
                  ? `<img src="${w.thumb}" alt="${w.title || ""}"/>`
                  : "ğŸ“„";
                card.innerHTML = `<div class="thumb">${t}</div>
                          <div class="meta"><span>${w.title || "æ–‡æ¡£"}</span>
                          <a class="open-btn" target="_blank" href="${
                            w.href
                          }">é¢„è§ˆ/ä¸‹è½½</a></div>`;
              }
              grid.appendChild(card);
            });
          }
          renderWorks(0);
        }

        placeLike(); // ä¿è¯åˆ‡æ¢å â¤ ä»å¯¹é½
      }

      /* ====== çƒ­åŒºç‚¹å‡»ï¼ˆæ”¾åœ¨å‡½æ•°å£°æ˜ä¹‹åï¼‰ ====== */
      svg.querySelectorAll(".hit").forEach((poly) => {
        poly.addEventListener("click", () => {
          if (poly.id === "heartZone") {
            toggleLike();
            return;
          }
          openPage(poly.id);
        });
      });
    </script>
  </body>
</html>
